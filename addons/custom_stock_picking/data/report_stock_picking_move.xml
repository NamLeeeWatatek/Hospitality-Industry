<?xml version='1.0' encoding='UTF-8'?>
<odoo>

  <record id="stock.report_delivery_document" model="ir.ui.view"
    forcecreate="1">
    <field name="arch" type="xml">
      <t t-name="stock.report_delivery_document">
        <t t-call="web.html_container">
          <div style="font-family: 'Noto Sans Khmer', sans-serif;">
            <t t-call="web.external_layout">
              <t t-set="o" t-value="o.with_context(lang=o._get_report_lang())" />
              <style type="text/css">
                @font-face {
                font-family: 'Noto Sans Khmer';
                src:
                url('/custom_stock_picking/static/src/fonts/NotoSansKhmer-VariableFont_wdth,wght.ttf')
                format('truetype');
                }
                * {
                font-family: 'Noto Sans Khmer', sans-serif !important;
                }

                strong, span, div, p, h1, h2, h3, td, th {
                color: black !important;
                background-color: white !important;
                }

                h2 &gt; span {
                font-size: 25px !important;
                font-weight: bold !important;
                }

                th &gt; span {
                font-weight: bold !important;
                }

                tr &gt; th {
                border-color: black !important;
                }

                span, strong, div {
                font-size: 18px !important;
                color: black !important;
                }

                td, th, th &gt; span {
                font-size: 14px !important;
                color: black !important;
                }

                .o_body_html .header {
                display: none;
                }

                .o_table_boxed table:not(.o_ignore_layout_styling) thead th:not(:last-child),
                .o_table_boxed-rounded table:not(.o_ignore_layout_styling) thead th:not(:last-child)
                {
                border-right: 2px solid black;
                }

                .o_table_boxed table:not(.o_ignore_layout_styling) thead th, .o_table_boxed-rounded
                table:not(.o_ignore_layout_styling) thead th {
                border-bottom: 2px solid black;
                }

                .o_table_boxed table:not(.o_ignore_layout_styling) tbody td:not(:last-child),
                .o_table_boxed-rounded table:not(.o_ignore_layout_styling) tbody td:not(:last-child)
                {
                border-right: 2px solid black;
                }

                .o_table_boxed table:not(.o_ignore_layout_styling) tbody tr:not(:last-child) td,
                .o_table_boxed-rounded table:not(.o_ignore_layout_styling) tbody tr:not(:last-child)
                td
                {
                border-bottom: 2px solid black;
                }

                .o_table_boxed table:not(.o_ignore_layout_styling)::before, .o_table_boxed-rounded
                table:not(.o_ignore_layout_styling)::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                bottom: 0;
                right: 0;
                pointer-events: none;
                border: 2px solid black;
                }

                .o_table_boxed-rounded table:not(.o_ignore_layout_styling) th {
                border-color: black !important;
                }
              </style>
              <t t-set="partner"
                t-value="o.partner_id or (o.move_ids and o.move_ids[0].partner_id) or False" />
              <div class="w-100 col-5 text-center fw-bold text-24 fs-2 mt-2" name="div_header">
                <t t-if="o.company_id.id == 1">
                  PHIẾU XUẤT KHO GIAO HÀNG
                </t>
                <t t-else=""> បង្កាន់ដៃដឹកជញ្ជូន<br /> DELIVERY NOTE </t>
              </div>
              <div class="row my-4" style="font-family: 'Noto Sans Khmer', sans-serif;">
                <!-- BÊN TRÁI: Thông tin đối tác -->
                <div class="col-6" name="div_incoming_address">
                  <t t-set="show_partner" t-value="False" />
                  <div name="vendor_address" t-if="o.picking_type_id.code=='incoming' and partner">
                    <strong>
                      <t t-if="o.company_id.id == 1">
                        Địa chỉ nhà cung cấp
                      </t>
                      <t t-else="">
                        <!-- អាសយដ្ឋានអ្នកផ្គត់ផ្គង់<br/> --> SUPPLIER ADDRESS </t>
                    </strong>
                    <t t-set="show_partner" t-value="True" />
                  </div>
                  <div name="customer_address"
                    t-if="o.picking_type_id.code=='outgoing' and partner and partner != partner.commercial_partner_id">
                    <strong>Địa chỉ khách hàng</strong>
                    <t t-set="show_partner" t-value="True" />
                  </div>
                  <div t-if="show_partner" name="partner_header">
                    <div t-field="partner.commercial_partner_id"
                      t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;, &quot;vat&quot;], &quot;no_marker&quot;: True, &quot;phone_icons&quot;: True}" />
                  </div>

                  <div name="outgoing_delivery_address" t-if="o.should_print_delivery_address()"
                    style="text-align: left;">
                    <strong>
                      <t t-if="o.company_id.id == 1">
                        Công ty/ Khách hàng:
                      </t>
                      <t t-else="">
                        <!-- ក្រុមហ៊ុន/អតិថិជន:<br/> --> COMPANY / CUSTOMER: </t>
                    </strong>
                    <div t-field="o.move_ids[0].partner_id" style="display: inline" />
                    <br />
                    <strong>
                      <t t-if="o.company_id.id == 1">
                        Địa chỉ giao hàng:
                      </t>
                      <t t-else="">
                        <!-- អាសយដ្ឋានប្រគល់ទំនិញ:<br/> --> DELIVERY ADDRESS: </t>
                    </strong>
                    <div t-field="o.move_ids[0].partner_id.contact_address" style="display: inline" />
                    <br />
                    <strong>
                      <t t-if="o.company_id.id == 1">
                        Nội dung bổ sung:
                      </t>
                      <t t-else="">
                        <!-- ខ្លឹមសារបន្ថែម:<br/> --> ADDITIONAL NOTES: </t>
                    </strong>
                    <div style="display: inline">___________________________________</div>
                    <br />
                    <div class="mt-2">________________________________________________________</div>
                  </div>
                </div>
                <!-- BÊN PHẢI: Thông tin vận chuyển -->
                <div class="col-6" name="div_outgoing_address">
                  <div t-if="o.state" class="w-100 mb-1">
                    <strong>
                      <t t-if="o.company_id.id == 1">
                        Ngày vận chuyển:
                      </t>
                      <t t-else="">
                        <!-- កាលបរិច្ឆេទដឹកជញ្ជូន:<br/> --> DELIVERY DATE: </t>
                    </strong>
                    <div t-if="o.state == 'done'" t-esc="o.date_done.strftime('%d/%m/%Y')"
                      style="display: inline" />
                    <div t-else="" t-field="o.scheduled_date" class="m-0" style="display: inline" />
                  </div>
                  <div t-if="o.state" class="w-100 mb-1">
                    <strong>
                      <t t-if="o.company_id.id == 1">
                        Biển số xe:
                      </t>
                      <t t-else="">
                        <!-- លេខផ្លាកឡាន:<br/> --> VEHICLE LICENSE PLATE: </t>
                    </strong>
                    <div t-field="o.bien_so_xe" class="m-0" style="display: inline" />
                  </div>
                  <div t-if="o.state" class="w-100 mb-1">
                    <strong>
                      <t t-if="o.company_id.id == 1">
                        Mã đơn hàng:
                      </t>
                      <t t-else="">
                        <!-- កូដបញ្ជាទិញ:<br/> --> ORDER CODE: </t>
                    </strong>
                    <div t-field="o.origin" class="m-0" style="display: inline" />
                  </div>
                  <div t-if="o.state" class="w-100 mb-1">
                    <strong>
                      <t t-if="o.company_id.id == 1">
                        Mã tài liệu:
                      </t>
                      <t t-else="">
                        <!-- កូដឯកសារ:<br/> --> DOCUMENT CODE: </t>
                    </strong>
                    <div t-field="o.name" class="m-0" style="display: inline" />
                  </div>
                  <div name="outgoing_delivery_address" t-if="o.should_print_delivery_address()"
                    style="text-align: left; display: none;">
                    <strong>Địa chỉ vận chuyển</strong>
                    <div t-field="o.move_ids[0].partner_id"
                      style="display: inline-block; text-align: right;" />
                    <div t-field="o.move_ids[0].partner_id.contact_address"
                      style="display: inline-block; text-align: right;" />
                  </div>
                  <div name="outgoing_warehouse_address"
                    t-elif="o.picking_type_id.code != 'internal' and o.picking_type_id.warehouse_id.partner_id"
                    style="display: none">
                    <strong>Địa chỉ kho hàng</strong>
                    <div t-field="o.picking_type_id.warehouse_id.partner_id"
                      t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;], &quot;no_marker&quot;: True, &quot;phone_icons&quot;: True}" />
                  </div>
                </div>
              </div>

              <div class="page" style="font-family: 'Noto Sans Khmer', sans-serif;">
                <!-- <h2 style="text-align: center; mb-2">
                  <span t-field="o.name">WH/OUT/0001</span>
                </h2> -->
                <!-- <div class="oe_structure" /> -->
                <div id="informations" class="row mb-4" style="display: none">
                  <div t-if="o.origin" class="col col-3 mw-100 mb-2" name="div_origin">
                    <strong>Đơn hàng</strong>
                    <div t-field="o.origin" class="m-0">S0001</div>
                  </div>
                  <div t-if="o.state" class="col col-3 mw-100 mb-2" name="div_sched_date">
                    <strong>Ngày vận chuyển</strong>
                    <div t-if="o.state == 'done'" t-esc="o.date_done.strftime('%d/%m/%Y')"
                      class="m-0" />
                    <div t-else="" t-field="o.scheduled_date" class="m-0" />
                  </div>
                </div>
                <!-- <div class="oe_structure" /> -->
                <table class="table table-borderless" t-if="o.state!='done'" name="stock_move_table"
                  style="font-family: 'Noto Sans Khmer', sans-serif;">
                  <thead>
                    <tr>
                      <th name="th_sm_stt" style="width: 30px;">
                        <strong>
                          <t t-if="o.company_id.id == 1">
                            STT
                          </t>
                          <t t-else=""> លេខសម្គាល់:<br /> SERIAL NUMBER: </t>
                        </strong>
                      </th>
                      <th name="th_sm_product">
                        <strong>
                          <t t-if="o.company_id.id == 1">
                            Tên sản phẩm, hàng hóa
                          </t>
                          <t t-else=""> ឈ្មោះផលិតផល, ទំនិញ:<br /> PRODUCT NAME, GOODS: </t>
                        </strong>
                      </th>
                      <th class="text-start">
                        <strong>
                          <t t-if="o.company_id.id == 1">
                            Đơn vị tính
                          </t>
                          <t t-else=""> អង្គភាពម៉ាស៊ីន:<br /> UNIT OF MEASURE: </t>
                        </strong>
                      </th>
                      <th name="th_sm_ordered" class="text-end">
                        <strong>
                          <t t-if="o.company_id.id == 1">
                            Số lượng đặt
                          </t>
                          <t t-else=""> បរិមាណបញ្ជាទិញ:<br /> ORDER QUANTITY: </t>
                        </strong>
                      </th>
                      <th name="th_sm_quantity" class="text-end">
                        <strong>
                          <t t-if="o.company_id.id == 1">
                            Số lượng gửi đến
                          </t>
                          <t t-else=""> បរិមាណដឹកជញ្ជូន:<br /> QUANTITY SHIPPED: </t>
                        </strong>
                      </th>
                      <th name="th_sm_description" class="text-end">
                        <strong>
                          <t t-if="o.company_id.id == 1">
                            Ghi chú
                          </t>
                          <t t-else=""> កំណត់សម្គាល់:<br /> NOTES: </t>
                        </strong>
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <t t-set="lines" t-value="o.move_ids.filtered(lambda x: x.product_uom_qty)" />
                    <tr t-foreach="lines" t-as="move">
                      <td>
                        <span t-field="move.product_id"
                          style="font-family: 'Noto Sans Khmer', sans-serif;">Bàn điều chỉnh được</span>
                        <p
                          t-if="move.description_picking and move.description_picking != move.product_id.name and move.description_picking != move.product_id.display_name">
                          <span t-field="move.description_picking"
                            style="font-family: 'Noto Sans Khmer', sans-serif;">Mô tả lệnh chuyển
                            hàng</span>
                        </p>
                      </td>
                      <td class="text-end">
                        <span t-field="move.product_uom" t-if="not move.picking_id.is_consignment"
                          groups="uom.group_uom" />
                        <span t-if="move.picking_id.is_consignment"
                          t-field="move.consignment_packed_type" />
                        <span t-if="move.product_packaging_id"> ( <span
                            t-field="move.product_packaging_qty"
                            t-options="{&quot;widget&quot;: &quot;integer&quot;}" />
                                            <span
                            t-field="move.product_packaging_id" />) </span>
                      </td>
                      <td class="text-end">
                        <span t-field="move.product_uom_qty" />
                        <span t-field="move.product_uom" t-if="not move.picking_id.is_consignment"
                          groups="uom.group_uom" />
                        <span t-if="move.picking_id.is_consignment"
                          t-field="move.consignment_packed_type" />
                        <span t-if="move.product_packaging_id"> ( <span
                            t-field="move.product_packaging_qty"
                            t-options="{&quot;widget&quot;: &quot;integer&quot;}" />
                                            <span
                            t-field="move.product_packaging_id" />) </span>
                      </td>
                      <td class="text-end">
                        <span t-field="move.quantity" />
                        <span t-field="move.product_uom" t-if="not move.picking_id.is_consignment"
                          groups="uom.group_uom" />
                        <span t-if="move.picking_id.is_consignment"
                          t-field="move.consignment_packed_type" />
                        <span t-if="move.product_packaging_id"> ( <span
                            t-field="move.product_packaging_quantity"
                            t-options="{&quot;widget&quot;: &quot;integer&quot;}" />
                                            <span
                            t-field="move.product_packaging_id" />) </span>
                      </td>
                      <td class="text-start">
                        <span t-field="move.unit_of_measure" />
                      </td>
                    </tr>
                  </tbody>
                </table>
                <table class="table table-borderless"
                  t-elif="o.move_ids_without_package.move_line_ids and o.state=='done'"
                  name="stock_move_line_table">
                  <t t-set="has_serial_number" t-value="False" />
                  <t t-set="has_serial_number"
                    t-value="o.move_ids_without_package.move_line_ids.mapped('lot_id')"
                    groups="stock.group_lot_on_delivery_slip" />
                  <thead>
                    <tr>
                      <th name="th_sm_stt" style="width: 30px;">
                        <strong>
                          <t t-if="o.company_id.id == 1">
                            STT
                          </t>
                          <t t-else="">ល.រ<br />No.</t>
                        </strong>
                      </th>
                      <th name="th_sm_product">
                        <strong>
                          <t t-if="o.company_id.id == 1">
                            Tên sản phẩm, hàng hóa
                          </t>
                          <t t-else=""> ឈ្មោះផលិតផល, ទំនិញ<br /> PRODUCT NAME, GOODS</t>
                        </strong>
                      </th>
                      <th class="text-start">
                        <strong>
                          <t t-if="o.company_id.id == 1">
                            ĐVT
                          </t>
                          <t t-else=""> អង្គភាពម៉ាស៊ីន<br /> UoM</t>
                        </strong>
                      </th>
                      <th class="text-start">
                        <strong>
                          <t t-if="o.company_id.id == 1">
                            Quy cách
                          </t>
                          <t t-else=""> លក្ខណៈ<br /> SPECIFICATIONS</t>
                        </strong>
                      </th>
                      <th name="th_sm_ordered" class="text-start">
                        <strong>
                          <t t-if="o.company_id.id == 1">
                            Số lượng đặt
                          </t>
                          <t t-else=""> បរិមាណបញ្ជាទិញ<br /> ORDER QUANTITY</t>
                        </strong>
                      </th>
                      <th name="th_sm_quantity" class="text-start">
                        <strong>
                          <t t-if="o.company_id.id == 1">
                            Số lượng gửi đến
                          </t>
                          <t t-else=""> បរិមាណដឹកជញ្ជូន<br /> QUANTITY SHIPPED</t>
                        </strong>
                      </th>
                      <th name="th_sm_description" class="text-start" style="width: 200px;">
                        <strong>
                          <t t-if="o.company_id.id == 1">
                            Ghi chú
                          </t>
                          <t t-else=""> កំណត់សម្គាល់<br /> NOTES</t>
                        </strong>
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- This part gets complicated with different use cases (additional use
                            cases in extensions of this report):
                                    1. If serial numbers are used and set to print on delivery slip => print lines as is, otherwise
                            group them by overlapping
                                        product + description + uom combinations
                                    2. If any packages are assigned => split products up by package (or non-package) and then apply use
                            case 1 -->
                    <!-- If has destination packages => create sections of corresponding
                            products -->

                    <t t-if="o.has_packages" name="has_packages">
                      <t t-set="packages"
                        t-value="o.move_ids_without_package.move_line_ids.mapped('result_package_id')" />
                      <t t-foreach="packages" t-as="package">
                        <t t-call="stock.stock_report_delivery_package_section_line" />
                        <t t-set="package_move_lines"
                          t-value="o.move_ids_without_package.move_line_ids.filtered(lambda l: l.result_package_id == package)" />
                        <!-- If printing lots/serial numbers => keep products in original
                                    lines -->
                        <t t-if="has_serial_number">
                          <tr t-foreach="package_move_lines" t-as="move_line">
                            <t t-call="stock.stock_report_delivery_has_serial_move_line" />
                          </tr>
                        </t>
                        <!-- If not printing lots/serial numbers => merge lines with same
                                    product+description+uom -->
                        <t t-else="">
                          <t t-set="aggregated_lines"
                            t-value="package_move_lines._get_aggregated_product_quantities(strict=True)" />
                          <t t-call="stock.stock_report_delivery_aggregated_move_lines" />
                        </t>
                      </t>
                      <!-- Make sure we do another section for package-less products if they
                                exist -->
                      <t t-set="move_lines"
                        t-value="o.move_ids_without_package.move_line_ids.filtered(lambda l: not l.result_package_id)" />
                      <t t-set="aggregated_lines"
                        t-value="o.move_ids_without_package.move_line_ids._get_aggregated_product_quantities(except_package=True)" />
                      <t t-if="move_lines or aggregated_lines" name="no_package_move_lines">
                        <t t-call="stock.stock_report_delivery_no_package_section_line"
                          name="no_package_section" />
                        <t t-if="has_serial_number">
                          <tr t-foreach="move_lines" t-as="move_line">
                            <t t-call="stock.stock_report_delivery_has_serial_move_line" />
                          </tr>
                        </t>
                        <t t-elif="aggregated_lines">
                          <t t-call="stock.stock_report_delivery_aggregated_move_lines" />
                        </t>
                      </t>
                    </t>
                    <!-- No destination packages -->
                    <t t-else="">
                      <t t-if="has_serial_number">
                        <tr t-foreach="o.move_ids_without_package.move_line_ids" t-as="move_line">
                          <t t-call="stock.stock_report_delivery_has_serial_move_line" />
                        </tr>
                      </t>
                      <t t-else="" name="aggregated_move_lines">
                        <t t-set="aggregated_lines_dict"
                          t-value="o.move_ids_without_package.move_line_ids._get_aggregated_product_quantities()" />
                        <t t-set="aggregated_lines" t-value="aggregated_lines_dict.items()" />
                        <t t-set="i_delivery" t-value="0" />
                        <tr t-foreach="aggregated_lines" t-as="line">
                          <td class="text-center">
                            <t t-set="i_delivery" t-value="i_delivery+1" />
                            <span t-esc="i_delivery" />
                          </td>
                          <td>
                            <span t-esc="line[1]['name']" />
                            <p t-if="line[1]['description']">
                              <span t-esc="line[1]['description']" t-options="{'widget': 'text'}" />
                            </p>
                          </td>
                          <td>
                            <span t-esc="line[1]['move'].unit_of_measure" />
                          </td>
                          <td>
                            <span t-esc="line[1]['product_uom'].name" />
                          </td>
                          <td class="text-center" name="move_line_aggregated_qty_ordered">
                            <span t-esc="line[1]['qty_ordered']"
                              t-options="{'widget': 'float', 'decimal_precision': 'Product Unit of Measure'}" />
                            <!-- <span t-esc="line[1]['product_uom'].name" /> -->
                            <span t-if="line[1]['packaging'].name"> (<span
                                t-out="line[1]['packaging_qty']" t-options="{'widget': 'integer'}" /> <span
                                t-out="line[1]['packaging'].name" />) </span>
                          </td>
                          <td class="text-center" name="move_line_aggregated_quantity">
                            <t t-if="line[1]['quantity']">
                              <span t-esc="line[1]['quantity']"
                                t-options="{'widget': 'float', 'decimal_precision': 'Product Unit of Measure'}" />
                              <!-- <span t-esc="line[1]['product_uom'].name" /> -->
                              <span t-if="line[1]['packaging'].name"> (<span
                                  t-out="line[1]['packaging_quantity']"
                                  t-options="{'widget': 'integer'}" /> <span
                                  t-out="line[1]['packaging'].name" />) </span>
                            </t>
                          </td>
                          <td name="text-description">
                            <span t-esc="line[1]['move'].sale_line_id.product_uom_qty" />
                            <span t-esc="line[1]['move'].sale_line_id.unit_of_measure" />
                            <span t-if="line[1]['move'].sale_line_id.product_uom.name == 'kg'">1</span>
                            <span t-esc="line[1]['move'].sale_line_id.product_uom.name" />
                          </td>
                        </tr>
                        <!-- Add empty rows if less than 10 -->
                        <t t-if="i_delivery &lt; 10">
                          <t t-set="i_remaining" t-value="10 - i_delivery" />
                          <tr t-foreach="range(i_remaining)" t-as="dummy">
                            <td class="text-center">
                              <span t-esc="i_delivery + dummy + 1" />
                            </td>
                            <td>
                              <br />
                            </td>
                            <td>
                              <br />
                            </td>
                            <td>
                              <br />
                            </td>
                            <td class="text-center" name="move_line_aggregated_qty_ordered">
                              <br />
                            </td>
                            <td class="text-center" name="move_line_aggregated_quantity">
                              <br />
                            </td>
                            <td name="text-description">
                              <br />
                            </td>
                          </tr>
                        </t>
                      </t>
                    </t>
                  </tbody>
                </table>
                <div class="mt4" name="signatures">
                  <div class="row" style="font-family: 'Noto Sans Khmer', sans-serif;">
                    <div class="col-3 text-center">
                      <t t-if="o.company_id.id == 1">
                        <strong style="font-family: 'Noto Sans Khmer', sans-serif;">Người lập phiếu</strong>
                      </t>
                      <t t-else="">
                        <span style="font-family: 'Noto Sans Khmer', sans-serif;"><strong>
                          អ្នករៀបចំឯកសារ</strong><br />Prepared by</span>
                      </t>
                      <div style="height: 3cm;"> </div>
                    </div>
                    <div class="col-3 text-center">
                      <t t-if="o.company_id.id == 1">
                        <strong style="font-family: 'Noto Sans Khmer', sans-serif;">Người nhận hàng</strong>
                      </t>
                      <t t-else="">
                        <span style="font-family: 'Noto Sans Khmer', sans-serif;"><strong>
                          អ្នកទទួលទំនិញ</strong><br /> Receiver</span>
                      </t>
                      <div style="height: 3cm;"> </div>
                    </div>
                    <div class="col-3 text-center">
                      <t t-if="o.company_id.id == 1">
                        <strong style="font-family: 'Noto Sans Khmer', sans-serif;">Người bán</strong>
                      </t>
                      <t t-else="">
                        <span style="font-family: 'Noto Sans Khmer', sans-serif;"><strong>អ្នកលក់</strong><br />
                          Seller</span>
                      </t>
                      <div style="height: 3cm;"> </div>
                    </div>
                    <div class="col-3 text-center">
                      <t t-if="o.company_id.id == 1">
                        <strong style="font-family: 'Noto Sans Khmer', sans-serif;">GĐ/KTT</strong>
                      </t>
                      <t t-else="">
                        <span style="font-family: 'Noto Sans Khmer', sans-serif;"><strong>
                          នាយក/គណនេយ្យ</strong><br /> Director/Accountant</span>
                      </t>
                      <div style="height: 3cm;"> </div>
                    </div>
                  </div>
                </div>
                <div class="oe_structure" />
                <t t-set="backorders"
                  t-value="o.backorder_ids.filtered(lambda x: x.state not in ('done', 'cancel'))" />
                <div t-if="not (o.backorder_ids and backorders)" class="oe_structure" />
                <div t-else="">
                  <p class="mt-5">
                    <span>Số lượng còn lại chưa giao:</span>
                  </p>
                  <table class="table table-borderless" name="stock_backorder_table">
                    <thead>
                      <tr>
                        <th name="th_sb_product">
                          <strong>Sản phẩm</strong>
                        </th>
                        <th />
                        <th name="th_sb_quantity" class="text-center">
                          <strong>Số lượng</strong>
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr
                        t-foreach="backorders.mapped('move_ids').filtered(lambda x: x.product_uom_qty)"
                        t-as="bo_line">
                        <td class="w-auto">
                          <span t-field="bo_line.product_id">Ghế văn phòng</span>
                          <p
                            t-if="bo_line.description_picking and bo_line.description_picking != bo_line.product_id.name and bo_line.description_picking != bo_line.product_id.display_name">
                            <span t-field="bo_line.description_picking">Description on
                              transfer</span>
                          </p>
                        </td>
                        <td />
                        <td class="text-center w-auto">
                          <span t-field="bo_line.product_uom_qty">3.00</span>
                          <span t-field="bo_line.product_uom" groups="uom.group_uom">đơn vị</span>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <div t-if="not o.signature" class="oe_structure" />
                <div t-else="" class="mt32 ml64 mr4" name="signature">
                  <div class="offset-8">
                    <strong>Chữ ký</strong>
                  </div>
                  <div class="offset-8">
                    <img t-att-src="image_data_uri(o.signature)"
                      style="max-height: 4cm; max-width: 8cm;" />
                  </div>
                  <div t-if="o.partner_id.name" class="offset-8 text-center">
                    <p t-field="o.partner_id.name">John Doe</p>
                  </div>
                </div>
              </div>
            </t>
          </div>
        </t>
      </t>
    </field>
    <field name="key">stock.report_delivery_document</field>
    <field name="name">report_delivery_document</field>
    <field name="type">qweb</field>
  </record>
  <record id="stock_report_non_barcode_custom" model="ir.ui.view">
    <field name="active" eval="False" />
    <field name="arch" type="xml">
      <t t-name="stock.report_delivery_document">
        <t t-call="web.html_container">
          <t t-call="web.external_layout">
            <t t-set="o" t-value="o.with_context(lang=o._get_report_lang())" />
            <t t-set="partner"
              t-value="o.partner_id or (o.move_ids and o.move_ids[0].partner_id) or False" />
            <t t-set="address">
              <div name="div_outgoing_address" style="font-family: 'Noto Sans Khmer', sans-serif;">
                <div name="outgoing_delivery_address" t-if="o.should_print_delivery_address()">
                  <strong>Địa chỉ giao</strong>
                  <div t-field="o.move_ids[0].partner_id"
                    t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;], &quot;no_marker&quot;: True, &quot;phone_icons&quot;: True}" />
                </div>
                <div name="outgoing_warehouse_address"
                  t-elif="o.picking_type_id.code != 'internal' and o.picking_type_id.warehouse_id.partner_id">
                  <strong>Địa chỉ kho</strong>
                  <div t-field="o.picking_type_id.warehouse_id.partner_id"
                    t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;], &quot;no_marker&quot;: True, &quot;phone_icons&quot;: True}" />
                </div>
              </div>
            </t>
            <t t-set="information_block">
              <div class="row" style="font-family: 'Noto Sans Khmer', sans-serif;">
                <div class="col-7" name="div_incoming_address">
                  <t t-set="show_partner" t-value="False" />
                  <div name="vendor_address" t-if="o.picking_type_id.code=='incoming' and partner">
                    <strong>Địa chỉ nhà cung cấp</strong>
                    <t t-set="show_partner" t-value="True" />
                  </div>
                  <div name="customer_address"
                    t-if="o.picking_type_id.code=='outgoing' and partner and partner != partner.commercial_partner_id">
                    <strong>Địa chỉ khách hàng</strong>
                    <t t-set="show_partner" t-value="True" />
                  </div>
                  <div t-if="show_partner" name="partner_header">
                    <div t-field="partner.commercial_partner_id"
                      t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;, &quot;vat&quot;], &quot;no_marker&quot;: True, &quot;phone_icons&quot;: True}" />
                  </div>
                </div>
              </div>
            </t>
            <div class="page" style="font-family: 'Noto Sans Khmer', sans-serif;">
              <h2>
                <span t-field="o.name">WH/OUT/0001</span>
              </h2>
              <div class="oe_structure" />
              <div id="informations" class="row mb-4">
                <div t-if="o.origin" class="col col-3 mw-100 mb-2" name="div_origin">
                  <strong>Đơn hàng</strong>
                  <div t-field="o.origin" class="m-0">S0001</div>
                </div>
                <div t-if="o.state" class="col col-3 mw-100 mb-2" name="div_sched_date">
                  <strong>Shipping Date</strong>
                  <div t-if="o.state == 'done'" t-field="o.date_done" class="m-0" />
                  <div t-else="" t-field="o.scheduled_date" class="m-0" />
                </div>
              </div>
              <div class="oe_structure" />
              <table class="table table-borderless" t-if="o.state!='done'" name="stock_move_table">
                <thead>
                  <tr>
                    <th name="th_sm_product">Sản phẩm</th>
                    <th name="th_sm_ordered" class="text-end">Đã đặt</th>
                    <th name="th_sm_quantity" class="text-end">Đã gửi đến</th>
                    <th class="text-start">
                      <strong>Đơn vị tính</strong>
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <t t-set="lines" t-value="o.move_ids.filtered(lambda x: x.product_uom_qty)" />
                  <tr t-foreach="lines" t-as="move">
                    <td>
                      <span t-field="move.product_id">Bàn điều chỉnh được</span>
                      <p
                        t-if="move.description_picking and move.description_picking != move.product_id.name and move.description_picking != move.product_id.display_name">
                        <span t-field="move.description_picking">Mô tả lệnh chuyển hàng</span>
                      </p>
                    </td>
                    <td class="text-end">
                      <span t-field="move.product_uom_qty">3.00</span>
                      <span t-field="move.product_uom" t-if="not move.picking_id.is_consignment"
                        groups="uom.group_uom">đơn vị</span>
                      <span t-if="move.picking_id.is_consignment"
                        t-field="move.consignment_packed_type"></span>
                      <span t-if="move.product_packaging_id"> (<span
                          t-field="move.product_packaging_qty"
                          t-options="{&quot;widget&quot;: &quot;integer&quot;}" /> <span
                          t-field="move.product_packaging_id" />) </span>
                    </td>
                    <td class="text-end">
                      <span t-field="move.quantity">3.00</span>
                      <span t-field="move.product_uom" t-if="not move.picking_id.is_consignment"
                        groups="uom.group_uom">đơn vị</span>
                      <span t-if="move.picking_id.is_consignment"
                        t-field="move.consignment_packed_type"></span>
                      <span t-if="move.product_packaging_id"> (<span
                          t-field="move.product_packaging_quantity"
                          t-options="{&quot;widget&quot;: &quot;integer&quot;}" /> <span
                          t-field="move.product_packaging_id" />) </span>
                    </td>
                    <td class="text-start">
                      <span t-field="ml.move_id.unit_of_measure"></span>
                    </td>
                  </tr>
                </tbody>
              </table>
              <table class="table table-borderless mt48"
                t-elif="o.move_line_ids and o.state=='done'" name="stock_move_line_table">
                <t t-set="has_serial_number" t-value="False" />
                <t t-set="has_serial_number" t-value="o.move_line_ids.mapped('lot_id')"
                  groups="stock.group_lot_on_delivery_slip" />
                <thead>
                  <tr>
                    <th name="th_sml_product">Sản phẩm</th>
                    <th name="th_sml_qty_ordered" class="text-center" t-if="not has_serial_number">Đã
                      đặt</th>
                    <th name="lot_serial" t-else="">Số lô/sê-ri</th>
                    <th name="th_sml_quantity" class="text-center">Đã gửi đến</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- This part gets complicated with different use cases (additional use cases in
                  extensions of this report):
                                1. If serial numbers are used and set to print on delivery slip => print lines as is, otherwise
                  group them by overlapping
                                    product + description + uom combinations
                                2. If any packages are assigned => split products up by package (or non-package) and then apply use
                  case 1 -->
                  <!-- If has destination packages => create sections of corresponding products -->
                  <t t-if="o.has_packages" name="has_packages">
                    <t t-set="packages" t-value="o.move_line_ids.mapped('result_package_id')" />
                    <t t-foreach="packages" t-as="package">
                      <t t-call="stock.stock_report_delivery_package_section_line" />
                      <t t-set="package_move_lines"
                        t-value="o.move_line_ids.filtered(lambda l: l.result_package_id == package)" />
                      <!-- If printing lots/serial numbers => keep products in original lines -->
                      <t t-if="has_serial_number">
                        <tr t-foreach="package_move_lines" t-as="move_line">
                          <t t-call="stock.stock_report_delivery_has_serial_move_line" />
                        </tr>
                      </t>
                      <!-- If not printing lots/serial numbers => merge lines with same
                      product+description+uom -->
                      <t t-else="">
                        <t t-set="aggregated_lines"
                          t-value="package_move_lines._get_aggregated_product_quantities(strict=True)" />
                        <t t-call="stock.stock_report_delivery_aggregated_move_lines" />
                      </t>
                    </t>
                    <!-- Make sure we do another section for package-less products if they exist -->
                    <t t-set="move_lines"
                      t-value="o.move_line_ids.filtered(lambda l: not l.result_package_id)" />
                    <t t-set="aggregated_lines"
                      t-value="o.move_line_ids._get_aggregated_product_quantities(except_package=True)" />
                    <t t-if="move_lines or aggregated_lines" name="no_package_move_lines">
                      <t t-call="stock.stock_report_delivery_no_package_section_line"
                        name="no_package_section" />
                      <t t-if="has_serial_number">
                        <tr t-foreach="move_lines" t-as="move_line">
                          <t t-call="stock.stock_report_delivery_has_serial_move_line" />
                        </tr>
                      </t>
                      <t t-elif="aggregated_lines">
                        <t t-call="stock.stock_report_delivery_aggregated_move_lines" />
                      </t>
                    </t>
                  </t>
                  <!-- No destination packages -->
                  <t t-else="">
                    <!-- If printing lots/serial numbers => keep products in original lines -->
                    <t t-if="has_serial_number">
                      <tr t-foreach="o.move_line_ids" t-as="move_line">
                        <t t-call="stock.stock_report_delivery_has_serial_move_line" />
                      </tr>
                    </t>
                    <!-- If not printing lots/serial numbers => merge lines with same product -->
                    <t t-else="" name="aggregated_move_lines">
                      <t t-set="aggregated_lines"
                        t-value="o.move_line_ids._get_aggregated_product_quantities()" />
                      <t t-call="stock.stock_report_delivery_aggregated_move_lines" />
                    </t>
                  </t>
                </tbody>
              </table>
              <div class="oe_structure" />
              <t t-set="backorders"
                t-value="o.backorder_ids.filtered(lambda x: x.state not in ('done', 'cancel'))" />
              <div t-if="not (o.backorder_ids and backorders)" class="oe_structure" />
              <div t-else="">
                <p class="mt-5">
                  <span>Số lượng còn lại chưa giao:</span>
                </p>
                <table class="table table-borderless" name="stock_backorder_table">
                  <thead>
                    <tr>
                      <th name="th_sb_product">
                        <strong>Sản phẩm</strong>
                      </th>
                      <th />
                      <th name="th_sb_quantity" class="text-center">
                        <strong>Số lượng</strong>
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr
                      t-foreach="backorders.mapped('move_ids').filtered(lambda x: x.product_uom_qty)"
                      t-as="bo_line">
                      <td class="w-auto">
                        <span t-field="bo_line.product_id">Ghế văn phòng</span>
                        <p
                          t-if="bo_line.description_picking and bo_line.description_picking != bo_line.product_id.name and bo_line.description_picking != bo_line.product_id.display_name">
                          <span t-field="bo_line.description_picking">Mô tả lệnh chuyển hàng</span>
                        </p>
                      </td>
                      <td />
                      <td class="text-center w-auto">
                        <span t-field="bo_line.product_uom_qty">3.00</span>
                        <span t-field="bo_line.product_uom" groups="uom.group_uom">đơn vị</span>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div t-if="not o.signature" class="oe_structure" />
              <div t-else="" class="mt32 ml64 mr4" name="signature">
                <div class="offset-8">
                  <strong>Chữ ký</strong>
                </div>
                <div class="offset-8">
                  <img t-att-src="image_data_uri(o.signature)"
                    style="max-height: 4cm; max-width: 8cm;" />
                </div>
                <div t-if="o.partner_id.name" class="offset-8 text-center">
                  <p t-field="o.partner_id.name">John Doe</p>
                </div>
              </div>
            </div>
          </t>
        </t>
      </t>
    </field>
    <field name="key">_stock.report_delivery_document_custom</field>
    <field name="name">backup__report_delivery_document_custom</field>
    <field name="type">qweb</field>
  </record>
</odoo>